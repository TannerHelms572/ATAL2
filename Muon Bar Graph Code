library(dplyr)
library(ggplot2)

raw_data <- raw_data %>%
  mutate(Time_s = Ardn_time_ms / 1000,
         minute = floor(Time_s / 60))

detections_per_minute <- raw_data %>%
  group_by(minute) %>%
  summarise(detections = n(),
            detections_per_sec = detections / 60)


ggplot(detections_per_minute, aes(x = minute, y = detections_per_sec)) +
  geom_col(fill = "darkorange") +
  labs(title = "Average Muon Detections per Second (Per Minute Bin)",
       x = "Minute",
       y = "Detections per Second") +
  theme_minimal()
